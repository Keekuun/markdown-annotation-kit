# 交互行为

本文档详细说明了组件的交互行为。

## 添加批注

1. 用户在 Markdown 渲染区域选择文本
2. 选择完成后，在选区上方弹出输入框（PopoverEditor）
3. 用户在输入框中输入批注内容
4. 点击"确认"按钮后：
   - 组件自动生成新的批注 ID
   - 在 Markdown 中插入 `<mark_N></mark_N>` 标签
   - 原文中被标记的文本以下划线高亮显示
   - 侧边栏显示新的批注卡片

### 键盘快捷键

- `Esc`: 取消添加批注
- `Cmd/Ctrl + Enter`: 确认添加批注

## 编辑批注

1. 点击批注卡片上的"编辑"按钮
2. 批注卡片进入编辑模式，显示文本输入框
3. 修改批注内容后点击"确认"
4. 批注内容更新，Markdown 中的标签保持不变

## 删除批注

1. 点击批注卡片上的"删除"按钮
2. 组件自动从 Markdown 中移除对应的 `<mark_N></mark_N>` 标签
3. 批注卡片从侧边栏移除
4. 原文中的高亮效果消失

## 双向锚定

### 从原文到批注

- 点击原文中的高亮文本
- 侧边栏自动滚动到对应的批注卡片
- 批注卡片短暂高亮显示（1 秒）

### 从批注到原文

- 点击侧边栏中的批注卡片
- 原文自动滚动到对应的位置
- 高亮文本短暂闪烁提示（1 秒）

## 代码块中的批注

代码块中的文本也可以被标注：

1. 在代码块中选择文本
2. 输入批注内容
3. 批注会通过 DOM 操作添加到代码块中，而不是在 Markdown 文本中插入 HTML

## 注意事项

- 不能选择已标注的文本再次标注
- 代码块中的标注在渲染后通过 DOM 操作添加，不会影响原始 Markdown
- 批注 ID 必须唯一，组件会自动管理 ID 生成

