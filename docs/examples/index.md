# ä½¿ç”¨ç¤ºä¾‹

æœ¬æ–‡æ¡£æä¾›äº† `markdown-annotation-kit` çš„å„ç§ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹ä»£ç ã€‚

## ç›®å½•

- [äº¤äº’å¼æ¼”ç¤º](#äº¤äº’å¼æ¼”ç¤º) - ğŸ¯ **ç«‹å³ä½“éªŒ**
- [åŸºç¡€ç¤ºä¾‹](#åŸºç¡€ç¤ºä¾‹)
- [å—æ§æ¨¡å¼ç¤ºä¾‹](#å—æ§æ¨¡å¼ç¤ºä¾‹)
- [åŠ è½½å·²ä¿å­˜çš„æ‰¹æ³¨](#åŠ è½½å·²ä¿å­˜çš„æ‰¹æ³¨)
- [å®æ—¶ä¿å­˜åˆ°æœåŠ¡å™¨](#å®æ—¶ä¿å­˜åˆ°æœåŠ¡å™¨)
- [è‡ªå®šä¹‰æ ·å¼](#è‡ªå®šä¹‰æ ·å¼)
- [ä¸çŠ¶æ€ç®¡ç†åº“é›†æˆ](#ä¸çŠ¶æ€ç®¡ç†åº“é›†æˆ)
- [è¡¨å•é›†æˆ](#è¡¨å•é›†æˆ)

## äº¤äº’å¼æ¼”ç¤º

### ğŸ¯ ç«‹å³ä½“éªŒ

ç›´æ¥åœ¨ä¸‹æ–¹ä½“éªŒç»„ä»¶çš„æ‰€æœ‰åŠŸèƒ½ï¼š

<InteractiveDemo />

### æ¼”ç¤ºåŠŸèƒ½

åœ¨æ¼”ç¤ºä¸­ï¼Œä½ å¯ä»¥ï¼š

- âœ… **é€‰æ‹©æ–‡æœ¬** - åœ¨ Markdown å†…å®¹ä¸­é€‰æ‹©ä»»æ„æ–‡æœ¬
- âœ… **æ·»åŠ æ‰¹æ³¨** - åœ¨å¼¹å‡ºçš„è¾“å…¥æ¡†ä¸­è¾“å…¥æ‰¹æ³¨å†…å®¹
- âœ… **æŸ¥çœ‹æ‰¹æ³¨** - åœ¨å³ä¾§ä¾§è¾¹æ æŸ¥çœ‹æ‰€æœ‰æ‰¹æ³¨
- âœ… **ç¼–è¾‘æ‰¹æ³¨** - ç‚¹å‡»æ‰¹æ³¨å¡ç‰‡çš„ç¼–è¾‘æŒ‰é’®ä¿®æ”¹å†…å®¹
- âœ… **åˆ é™¤æ‰¹æ³¨** - ç‚¹å‡»æ‰¹æ³¨å¡ç‰‡çš„åˆ é™¤æŒ‰é’®ç§»é™¤æ‰¹æ³¨
- âœ… **åŒå‘é”šå®š** - ç‚¹å‡»é«˜äº®æ–‡æœ¬è·³è½¬åˆ°æ‰¹æ³¨ï¼Œç‚¹å‡»æ‰¹æ³¨è·³è½¬åˆ°æ–‡æœ¬
- âœ… **ä»£ç å—æ‰¹æ³¨** - åœ¨ä»£ç å—ä¸­é€‰æ‹©ä»£ç è¿›è¡Œæ‰¹æ³¨

### å¿«æ·é”®

- `Esc` - å–æ¶ˆæ·»åŠ æ‰¹æ³¨
- `Cmd/Ctrl + Enter` - å¿«é€Ÿç¡®è®¤æ·»åŠ æ‰¹æ³¨

### æç¤º

- é€‰ä¸­æ–‡æœ¬åï¼Œä¼šåœ¨æ–‡æœ¬ä¸Šæ–¹å¼¹å‡ºè¾“å…¥æ¡†
- æ‰¹æ³¨æ•°æ®ä¼šè‡ªåŠ¨ä¿å­˜åˆ°æµè§ˆå™¨çš„ localStorage
- å¯ä»¥æŸ¥çœ‹é¡µé¢åº•éƒ¨çš„æ•°æ®é¢„è§ˆï¼Œäº†è§£æ•°æ®ç»“æ„

### æœ¬åœ°å¼€å‘

å¦‚æœæƒ³åœ¨æœ¬åœ°è¿è¡Œå®Œæ•´çš„å¼€å‘ç¯å¢ƒï¼š

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/Keekuun/markdown-annotation-kit.git
cd markdown-annotation-kit

# å®‰è£…ä¾èµ–
pnpm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev
```

è®¿é—® `http://localhost:5173` å³å¯ä½“éªŒå®Œæ•´çš„äº¤äº’å¼æ¼”ç¤ºåŠŸèƒ½ã€‚

---

## åŸºç¡€ç¤ºä¾‹

æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼Œç»„ä»¶å†…éƒ¨ç®¡ç†çŠ¶æ€ã€‚

```tsx
import { MarkdownAnnotator } from "markdown-annotation-kit";
import "markdown-annotation-kit/styles.css";

function BasicExample() {
  const markdown = `# æ–‡æ¡£æ ‡é¢˜

è¿™æ˜¯ä¸€æ®µå¯ä»¥æ‰¹æ³¨çš„æ–‡æœ¬å†…å®¹ã€‚

## åŠŸèƒ½ç‰¹æ€§

- æ”¯æŒæ–‡æœ¬é€‰æ‹©
- æ”¯æŒæ‰¹æ³¨åˆ›å»º
- æ”¯æŒåŒå‘é”šå®š`;

  return (
    <div style={{ height: "100vh" }}>
      <MarkdownAnnotator defaultValue={markdown} />
    </div>
  );
}
```

## å—æ§æ¨¡å¼ç¤ºä¾‹

ä½¿ç”¨å—æ§æ¨¡å¼ï¼Œå®Œå…¨æ§åˆ¶ç»„ä»¶çŠ¶æ€ã€‚

```tsx
import { useState } from "react";
import { MarkdownAnnotator, AnnotationItem } from "markdown-annotation-kit";
import "markdown-annotation-kit/styles.css";

function ControlledExample() {
  const [markdown, setMarkdown] = useState(`# æ–‡æ¡£æ ‡é¢˜

è¿™æ˜¯ä¸€æ®µå¯ä»¥æ‰¹æ³¨çš„æ–‡æœ¬å†…å®¹ã€‚`);

  const [annotations, setAnnotations] = useState<AnnotationItem[]>([]);

  return (
    <div style={{ height: "100vh" }}>
      <MarkdownAnnotator
        value={markdown}
        onChange={setMarkdown}
        annotations={annotations}
        onAnnotationsChange={setAnnotations}
      />
    </div>
  );
}
```

## åŠ è½½å·²ä¿å­˜çš„æ‰¹æ³¨

ä»æœåŠ¡å™¨åŠ è½½å·²ä¿å­˜çš„æ‰¹æ³¨æ•°æ®ã€‚

```tsx
import { useState, useEffect } from "react";
import {
  MarkdownAnnotator,
  AnnotationItem,
  importAnnotationData,
} from "markdown-annotation-kit";
import "markdown-annotation-kit/styles.css";

function LoadSavedExample() {
  const [markdown, setMarkdown] = useState("");
  const [annotations, setAnnotations] = useState<AnnotationItem[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function loadData() {
      try {
        const response = await fetch("/api/load");
        const data = await response.json();
        const { markdown: loadedMarkdown, annotations: loadedAnnotations } =
          importAnnotationData(data);
        setMarkdown(loadedMarkdown);
        setAnnotations(loadedAnnotations);
      } catch (error) {
        console.error("åŠ è½½å¤±è´¥:", error);
      } finally {
        setLoading(false);
      }
    }
    loadData();
  }, []);

  if (loading) {
    return <div>åŠ è½½ä¸­...</div>;
  }

  return (
    <div style={{ height: "100vh" }}>
      <MarkdownAnnotator
        value={markdown}
        onChange={setMarkdown}
        annotations={annotations}
        onAnnotationsChange={setAnnotations}
      />
    </div>
  );
}
```

## å®æ—¶ä¿å­˜åˆ°æœåŠ¡å™¨

ä½¿ç”¨æŒä¹…åŒ–å›è°ƒå®æ—¶ä¿å­˜æ•°æ®ã€‚

```tsx
import { useState } from "react";
import {
  MarkdownAnnotator,
  AnnotationItem,
  createDebouncedPersistence,
  exportAnnotationData,
} from "markdown-annotation-kit";
import "markdown-annotation-kit/styles.css";

function RealTimeSaveExample() {
  const [markdown, setMarkdown] = useState(`# æ–‡æ¡£æ ‡é¢˜

è¿™æ˜¯ä¸€æ®µå¯ä»¥æ‰¹æ³¨çš„æ–‡æœ¬å†…å®¹ã€‚`);

  const [annotations, setAnnotations] = useState<AnnotationItem[]>([]);

  const handlePersistence = createDebouncedPersistence(async (data) => {
    try {
      await fetch("/api/save", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      });
      console.log("ä¿å­˜æˆåŠŸ");
    } catch (error) {
      console.error("ä¿å­˜å¤±è´¥:", error);
    }
  }, 1000);

  return (
    <div style={{ height: "100vh" }}>
      <MarkdownAnnotator
        value={markdown}
        onChange={setMarkdown}
        annotations={annotations}
        onAnnotationsChange={setAnnotations}
        onPersistence={handlePersistence}
        persistenceDebounce={1000}
      />
    </div>
  );
}
```

## è‡ªå®šä¹‰æ ·å¼

é€šè¿‡ CSS å˜é‡å’Œç±»åè‡ªå®šä¹‰æ ·å¼ã€‚

```tsx
import { MarkdownAnnotator } from "markdown-annotation-kit";
import "markdown-annotation-kit/styles.css";
import "./custom-styles.css";

function CustomStyleExample() {
  const markdown = `# æ–‡æ¡£æ ‡é¢˜

è¿™æ˜¯ä¸€æ®µå¯ä»¥æ‰¹æ³¨çš„æ–‡æœ¬å†…å®¹ã€‚`;

  return (
    <div style={{ height: "100vh" }}>
      <MarkdownAnnotator defaultValue={markdown} className="my-annotator" />
    </div>
  );
}
```

```css
/* custom-styles.css */
.my-annotator {
  --markdown-annotator-primary: #ff6b6b;
  --markdown-annotator-primary-hover: #ee5a5a;
}

.my-annotator .annotation-highlight {
  background-color: rgba(255, 107, 107, 0.1);
}
```

## ä¸çŠ¶æ€ç®¡ç†åº“é›†æˆ

ä¸ Redux æˆ– Zustand ç­‰çŠ¶æ€ç®¡ç†åº“é›†æˆã€‚

```tsx
import { useStore } from "./store";
import { MarkdownAnnotator } from "markdown-annotation-kit";
import "markdown-annotation-kit/styles.css";

function ZustandExample() {
  const { markdown, annotations, setMarkdown, setAnnotations } = useStore();

  return (
    <div style={{ height: "100vh" }}>
      <MarkdownAnnotator
        value={markdown}
        onChange={setMarkdown}
        annotations={annotations}
        onAnnotationsChange={setAnnotations}
      />
    </div>
  );
}
```

## è¡¨å•é›†æˆ

åœ¨è¡¨å•ä¸­ä½¿ç”¨ç»„ä»¶ã€‚

```tsx
import { useState } from "react";
import {
  MarkdownAnnotator,
  AnnotationItem,
  exportAnnotationData,
} from "markdown-annotation-kit";
import "markdown-annotation-kit/styles.css";

function FormExample() {
  const [markdown, setMarkdown] = useState("");
  const [annotations, setAnnotations] = useState<AnnotationItem[]>([]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    const data = exportAnnotationData(markdown, annotations);
    await fetch("/api/submit", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data),
    });
  };

  return (
    <form onSubmit={handleSubmit}>
      <div style={{ height: "600px" }}>
        <MarkdownAnnotator
          value={markdown}
          onChange={setMarkdown}
          annotations={annotations}
          onAnnotationsChange={setAnnotations}
        />
      </div>
      <button type="submit">æäº¤</button>
    </form>
  );
}
```
